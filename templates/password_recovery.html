<!DOCTYPE html>
<html>
<head>
    <title>Password Recovery - Communication_LTD</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="center">
        {% if stage == 'request' %}
            <h1>Password Recovery</h1>
            <form method="post" class="form-login">
                <div class="txt_field">
                    <input type="email" id="email" name="email" required>
                    <span></span>
                    <label for="email">Email:</label>
                </div>
                <input type="hidden" name="stage" value="request">
                <input type="submit" value="Reset Password">
            </form>
        {% elif stage == 'verify' %}
            <h1>Verify Token</h1>
            <form method="post">
                <input type="hidden" name="email" value="{{ email }}">
                <div class="txt_field">
                    <input type="text" id="token" name="token" required>
                    <span></span>
                    <label for="token">Token:</label>
                </div>
                <input type="hidden" name="stage" value="verify">
                <input type="submit" value="Verify Token">
            </form>
        {% elif stage == 'reset' %}
            <h1>Reset Password</h1>
            <form method="post" class="form-login">
                <input type="hidden" name="email" value="{{ email }}">
                <div class="txt_field">
                    <input type="password" id="new_password" name="new_password" required>
                    <span></span>
                    <label for="new_password">New Password:</label>
                </div>
                <input type="hidden" name="stage" value="reset">
                <input type="submit" value="Reset Password">
            </form>
        {% endif %}

        {% if get_flashed_messages() %}
            <div class="error-messages">
                {% for message in get_flashed_messages() %}
                    <textarea readonly class="error-message">{{ message }}</textarea>
                {% endfor %}
            </div>
        {% endif %}
        <div class="signup_link">
            <a href="{{ url_for('login') }}">Back to Login</a>
        </div>
    </div>
</body>
</html>
